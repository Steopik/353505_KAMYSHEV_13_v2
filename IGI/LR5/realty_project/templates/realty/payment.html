{% extends "base.html" %}
{% block title %}–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞{% endblock %}

{% block content %}
<article>
    <header>
        <h1>üí≥ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>
    </header>

    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è -->
    <nav class="card">
        <h3>–≠—Ç–∞–ø—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:</h3>
        <ol>
            <li>‚úÖ –í—ã–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤</li>
            <li>‚úÖ –ö–æ—Ä–∑–∏–Ω–∞</li>
            <li><mark>‚Üí –û–ø–ª–∞—Ç–∞</mark></li>
            <li>‚è≥ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</li>
        </ol>
    </nav>

    <!-- –§–æ—Ä–º–∞ –æ–ø–ª–∞—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø–æ–ª–µ–π -->
    <form method="post" action="{% url 'realty:payment' %}" novalidate>
        {% csrf_token %}
        
        <!-- –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
        <fieldset class="card">
            <legend><h2>üë§ –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2></legend>
            
            <label for="fullname">–ü–æ–ª–Ω–æ–µ –∏–º—è: <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ" aria-label="required">*</abbr></label><br>
            <input type="text" 
                   id="fullname" 
                   name="fullname" 
                   required 
                   placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"
                   pattern="[–ê-–Ø–∞-—è–Å—ë\s]{3,50}"
                   title="–¢–æ–ª—å–∫–æ –∫–∏—Ä–∏–ª–ª–∏—Ü–∞, –æ—Ç 3 –¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤"
                   autocomplete="name"
                   autofocus><br><br>
            
            <label for="email">Email: <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr></label><br>
            <input type="email" 
                   id="email" 
                   name="email" 
                   required 
                   placeholder="example@mail.ru"
                   autocomplete="email"><br><br>
            
            <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω: <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr></label><br>
            <input type="tel" 
                   id="phone" 
                   name="phone" 
                   required
                   pattern="\+375 \((29|25|44|33)\) [0-9]{3}-[0-9]{2}-[0-9]{2}"
                   placeholder="+375 (29) 123-45-67"
                   autocomplete="tel"><br><br>
            
            <label for="birthdate">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</label><br>
            <input type="date" 
                   id="birthdate" 
                   name="birthdate"
                   min="1900-01-01"
                   max="{{ 'now'|date:'Y-m-d' }}"><br><br>
            
            <label for="passport">–°–µ—Ä–∏—è –∏ –Ω–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞: <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr></label><br>
            <input type="text" 
                   id="passport" 
                   name="passport"
                   required
                   pattern="[A-Z]{2}[0-9]{7}"
                   placeholder="MP1234567"
                   title="–§–æ—Ä–º–∞—Ç: –¥–≤–µ –∑–∞–≥–ª–∞–≤–Ω—ã–µ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã –∏ 7 —Ü–∏—Ñ—Ä"><br><br>
        </fieldset>

        <!-- –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ -->
        <fieldset class="card">
            <legend><h2>üìç –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h2></legend>
            
            <label for="country">–°—Ç—Ä–∞–Ω–∞:</label><br>
            <select id="country" name="country" required>
                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É --</option>
                <option value="BY" selected>–ë–µ–ª–∞—Ä—É—Å—å</option>
                <option value="RU">–†–æ—Å—Å–∏—è</option>
                <option value="UA">–£–∫—Ä–∞–∏–Ω–∞</option>
                <option value="PL">–ü–æ–ª—å—à–∞</option>
                <option value="LT">–õ–∏—Ç–≤–∞</option>
            </select><br><br>
            
            <label for="city">–ì–æ—Ä–æ–¥: <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr></label><br>
            <input type="text" 
                   id="city" 
                   name="city"
                   required
                   list="cities"
                   placeholder="–ú–∏–Ω—Å–∫"
                   autocomplete="address-level2">
            <datalist id="cities">
                <option value="–ú–∏–Ω—Å–∫">
                <option value="–ì–æ–º–µ–ª—å">
                <option value="–ú–æ–≥–∏–ª–µ–≤">
                <option value="–í–∏—Ç–µ–±—Å–∫">
                <option value="–ì—Ä–æ–¥–Ω–æ">
                <option value="–ë—Ä–µ—Å—Ç">
            </datalist><br><br>
            
            <label for="street">–£–ª–∏—Ü–∞ –∏ –¥–æ–º: <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr></label><br>
            <input type="text" 
                   id="street" 
                   name="street"
                   required
                   placeholder="—É–ª. –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –¥. 58, –∫–≤. 10"
                   autocomplete="street-address"><br><br>
            
            <label for="postal">–ü–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å:</label><br>
            <input type="text" 
                   id="postal" 
                   name="postal"
                   pattern="[0-9]{6}"
                   placeholder="220030"
                   maxlength="6"
                   autocomplete="postal-code"><br><br>
        </fieldset>

        <!-- –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã -->
        <fieldset class="card">
            <legend><h2>üí∞ –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</h2></legend>
            
            <input type="radio" id="card" name="payment_method" value="card" checked required>
            <label for="card">üí≥ –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞</label><br>
            
            <input type="radio" id="cash" name="payment_method" value="cash">
            <label for="cash">üíµ –ù–∞–ª–∏—á–Ω—ã–µ –≤ –æ—Ñ–∏—Å–µ</label><br>
            
            <input type="radio" id="transfer" name="payment_method" value="transfer">
            <label for="transfer">üè¶ –ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥</label><br>
            
            <input type="radio" id="installment" name="payment_method" value="installment">
            <label for="installment">üìÖ –†–∞—Å—Å—Ä–æ—á–∫–∞</label><br><br>
            
            <!-- –î–µ—Ç–∞–ª–∏ –∫–∞—Ä—Ç—ã (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –æ–ø–ª–∞—Ç—ã –∫–∞—Ä—Ç–æ–π) -->
            <div id="card-details">
                <h4>–î–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã</h4>
                
                <label for="cardnumber">–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã: <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr></label><br>
                <input type="text" 
                       id="cardnumber" 
                       name="cardnumber"
                       pattern="[0-9]{4} [0-9]{4} [0-9]{4} [0-9]{4}"
                       placeholder="1234 5678 9012 3456"
                       maxlength="19"
                       autocomplete="cc-number"><br><br>
                
                <label for="cardholder">–ò–º—è –Ω–∞ –∫–∞—Ä—Ç–µ: <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr></label><br>
                <input type="text" 
                       id="cardholder" 
                       name="cardholder"
                       pattern="[A-Z\s]{3,30}"
                       placeholder="IVAN IVANOV"
                       autocomplete="cc-name"><br><br>
                
                <label for="expiry">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr></label><br>
                <input type="month" 
                       id="expiry" 
                       name="expiry"
                       min="{{ 'now'|date:'Y-m' }}"
                       autocomplete="cc-exp"><br><br>
                
                <label for="cvv">CVV/CVC: <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr></label><br>
                <input type="password" 
                       id="cvv" 
                       name="cvv"
                       pattern="[0-9]{3}"
                       maxlength="3"
                       placeholder="123"
                       autocomplete="cc-csc"><br><br>
            </div>
        </fieldset>

        <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ -->
        <fieldset class="card">
            <legend><h2>üìã –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</h2></legend>
            
            <input type="checkbox" id="insurance" name="insurance" value="yes">
            <label for="insurance">üõ°Ô∏è –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ —Å–¥–µ–ª–∫–∏ (+500 BYN)</label><br>
            
            <input type="checkbox" id="evaluation" name="evaluation" value="yes">
            <label for="evaluation">üìä –ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è –æ—Ü–µ–Ω–∫–∞ –æ–±—ä–µ–∫—Ç–∞ (+300 BYN)</label><br>
            
            <input type="checkbox" id="legal" name="legal" value="yes" checked>
            <label for="legal">‚öñÔ∏è –Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)</label><br>
            
            <input type="checkbox" id="delivery" name="delivery" value="yes">
            <label for="delivery">üöö –î–æ—Å—Ç–∞–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∫—É—Ä—å–µ—Ä–æ–º (+50 BYN)</label><br><br>
            
            <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É:</label><br>
            <textarea id="comment" 
                      name="comment" 
                      rows="4" 
                      cols="50"
                      maxlength="500"
                      placeholder="–í–∞—à–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è..."></textarea><br><br>
            
            <label for="preferred-date">–ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–∞—è –¥–∞—Ç–∞ —Å–¥–µ–ª–∫–∏:</label><br>
            <input type="date" 
                   id="preferred-date" 
                   name="preferred_date"
                   min="{{ 'now'|date:'Y-m-d' }}"><br><br>
            
            <label for="preferred-time">–ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è:</label><br>
            <input type="time" 
                   id="preferred-time" 
                   name="preferred_time"
                   min="09:00"
                   max="18:00"
                   step="1800"><br><br>
        </fieldset>

        <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ -->
        <section class="card">
            <h2>üìä –ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ</h2>
            <table>
                <caption>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–∞</caption>
                <tbody>
                    <tr>
                        <th scope="row">–û–±—ä–µ–∫—Ç—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏:</th>
                        <td><strong>{{ total_price|floatformat:0 }} BYN</strong></td>
                    </tr>
                    <tr>
                        <th scope="row">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏:</th>
                        <td><output id="additional-cost">0</output> BYN</td>
                    </tr>
                    <tr>
                        <th scope="row">–°–∫–∏–¥–∫–∞:</th>
                        <td><output id="discount">0</output> BYN</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <th scope="row">–ò–¢–û–ì–û:</th>
                        <td><strong><output id="total">{{ total_price|floatformat:0 }}</output> BYN</strong></td>
                    </tr>
                </tfoot>
            </table>
            
            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
            <label for="payment-progress">–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –æ–ø–ª–∞—Ç–µ:</label>
            <progress id="payment-progress" value="70" max="100">70%</progress>
        </section>

        <!-- –°–æ–≥–ª–∞—à–µ–Ω–∏—è -->
        <fieldset class="card">
            <legend><h3>üìÑ –°–æ–≥–ª–∞—à–µ–Ω–∏—è</h3></legend>
            
            <input type="checkbox" id="terms" name="terms" required>
            <label for="terms">
                –Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å <a href="{% url 'realty:privacy_policy' %}" target="_blank">—É—Å–ª–æ–≤–∏—è–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</a> 
                <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr>
            </label><br>
            
            <input type="checkbox" id="newsletter" name="newsletter">
            <label for="newsletter">–•–æ—á—É –ø–æ–ª—É—á–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</label><br><br>
            
            <!-- –ö–∞–ø—á–∞ (–ø—Ä–æ—Å—Ç–∞—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è) -->
            <label for="captcha">–ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–æ–±–æ—Ç–æ–≤: —Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç 2 + 3? <abbr title="–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ">*</abbr></label><br>
            <input type="number" 
                   id="captcha" 
                   name="captcha"
                   required
                   min="0"
                   max="10"
                   placeholder="?"
                   style="width: 50px;"><br><br>
        </fieldset>

        <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
        <nav class="card">
            <button type="submit" class="btn" style="background-color: #28a745;">
                ‚úÖ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
            </button>
            <button type="reset" class="btn" style="background-color: #ffc107;">
                üîÑ –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
            </button>
            <a href="{% url 'realty:cart' %}" class="btn" style="background-color: #6c757d;">
                ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ—Ä–∑–∏–Ω—É
            </a>
        </nav>
    </form>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ -->
    <aside class="card">
        <h3>üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–ª–∞—Ç–µ–∂–µ–π</h3>
        <p>–í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∑–∞—â–∏—â–µ–Ω—ã –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É <abbr title="Payment Card Industry Data Security Standard">PCI DSS</abbr>.</p>
        <p>–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º <kbd>SSL</kbd> —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∑–∞—â–∏—Ç—ã –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.</p>
        <p>–ö–æ–¥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: <code>SEC-2024-REALTY</code></p>
        <meter value="9" min="0" max="10" optimum="9">–£—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: 9/10</meter>
    </aside>
</article>

<script>
// –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ –¥–µ—Ç–∞–ª–µ–π –∫–∞—Ä—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
document.querySelectorAll('input[name="payment_method"]').forEach(radio => {
    radio.addEventListener('change', function() {
        document.getElementById('card-details').style.display = 
            this.value === 'card' ? 'block' : 'none';
    });
});

// –†–∞—Å—á–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª—É–≥
function calculateAdditional() {
    let cost = 0;
    if (document.getElementById('insurance').checked) cost += 500;
    if (document.getElementById('evaluation').checked) cost += 300;
    if (document.getElementById('delivery').checked) cost += 50;
    
    document.getElementById('additional-cost').value = cost;
    document.getElementById('total').value = {{ total_price }} + cost;
}

document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
    checkbox.addEventListener('change', calculateAdditional);
});
</script>

{% endblock %}